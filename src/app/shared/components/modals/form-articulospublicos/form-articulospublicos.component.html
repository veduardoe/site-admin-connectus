<h2 mat-dialog-title>Category Content</h2>
<mat-dialog-content class="dialog-content">

    <form [formGroup]="mainForm">

        <div fxLayout="row wrap" fxLayoutAlign="space-between center">
            <div fxFlex="100%">
                <h3 class="sst">Article Main Information</h3>
            </div>
            <div fxFlex="49%">

                <mat-form-field class="full" appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput formControlName="tituloSlider" required>
                    <mat-error *ngIf="mf.tituloSlider.errors">
                        <span *ngIf="mf.tituloSlider.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>

                <mat-form-field class="full" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="descripcionSlider" required>
                    <mat-error *ngIf="mf.descripcionSlider.errors">
                        <span *ngIf="mf.descripcionSlider.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>

            </div>

            <div fxFlex="49%">
                <span class="cmlabel">Slider Picture</span>
                <ng-container 
                    [ngTemplateOutlet]="picUploader" 
                    [ngTemplateOutletContext]="{ indexpic: 'imagenSlider', inputtext: 'UPLOAD' } ">
                </ng-container>
            </div>


            <div fxFlex="100%">
                <h3 class="sst">Article Detail - Section #1</h3>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput formControlName="sec1_titulo" required>
                    <mat-error *ngIf="mf.sec1_titulo.errors">
                        <span *ngIf="mf.sec1_titulo.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="sec1_descripcion" required>
                    <mat-error *ngIf="mf.sec1_descripcion.errors">
                        <span *ngIf="mf.sec1_descripcion.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>URL</mat-label>
                    <input matInput formControlName="sec1_url">
                </mat-form-field>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Enable Button URL</mat-label>
                    <mat-select formControlName="sec1_habilitarUrl" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.sec1_habilitarUrl.errors">
                        <span *ngIf="mf.sec1_habilitarUrl.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
            
            <div fxFlex="100%">
                <h3 class="sst">Article Detail - Section #2</h3>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput formControlName="sec2_titulo" required>
                    <mat-error *ngIf="mf.sec2_titulo.errors">
                        <span *ngIf="mf.sec2_titulo.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
            
            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="sec2_descripcion" required>
                    <mat-error *ngIf="mf.sec2_descripcion.errors">
                        <span *ngIf="mf.sec2_descripcion.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="33%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Icon FontAwesome</mat-label>
                    <input matInput formControlName="sec2_icono" required>
                    <mat-error *ngIf="mf.sec2_icono.errors">
                        <span *ngIf="mf.sec2_icono.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="33%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>URL</mat-label>
                    <input matInput formControlName="sec2_url" required>
                </mat-form-field>
            </div>

            <div fxFlex="33%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Enable Button URL</mat-label>
                    <mat-select formControlName="sec2_habilitarUrl" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div fxFlex="100%">
                <h3 class="sst">Article Detail - Section #3</h3>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput formControlName="sec3_titulo" required>
                </mat-form-field>

                <mat-form-field class="full" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="sec3_descripcion" required>
                </mat-form-field>
            </div>
            
            <div fxFlex="49%">
                <span class="cmlabel">Background Picture</span>
                <ng-container 
                    [ngTemplateOutlet]="picUploader" 
                    [ngTemplateOutletContext]="{ indexpic: 'sec3_imagen', inputtext: 'UPLOAD' } ">
                </ng-container>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>URL</mat-label>
                    <input matInput formControlName="sec3_url">
                </mat-form-field>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Enable Button URL</mat-label>
                    <mat-select formControlName="sec3_habilitarUrl" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.sec3_habilitarUrl.errors">
                        <span *ngIf="mf.sec3_habilitarUrl.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="100%">
                <h3 class="sst">Article Detail - Section #3 (4 items)</h3>
            </div>
            <div fxFlex="100%" formGroupName="sec3_infos">
                <div formArrayName="items">
                    <div *ngFor="let j of [].constructor(4); let i = index" class="stitm">
                        <div class="itms" fxLayout="row wrap" fxLayoutAlign="space-between center" [formGroupName]="i">
                            <div fxFlex="100%">
                                <h3 class="sst">Item #{{ i + 1 }}</h3>
                            </div>
                            <div fxFlex="24%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>Icon</mat-label>
                                    <input matInput formControlName="icon">
                                </mat-form-field>
                            </div>
                            <div fxFlex="24%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>Short Title</mat-label>
                                    <input matInput formControlName="tituloCorto">
                                </mat-form-field>
                            </div>
                            <div fxFlex="24%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>URL</mat-label>
                                    <input matInput formControlName="url">
                                </mat-form-field>
                            </div>
                            <div fxFlex="24%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>Enable Button URL</mat-label>
                                    <mat-select formControlName="habilitarUrl">
                                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div fxFlex="33%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>Long Title</mat-label>
                                    <input matInput formControlName="tituloLargo">
                                </mat-form-field>
                            </div>
                            <div fxFlex="66%">
                                <mat-form-field class="full" appearance="outline">
                                    <mat-label>Descripción</mat-label>
                                    <input matInput formControlName="descripcion">
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div fxFlex="100%">
                <h3 class="sst">Article Detail - Section #4</h3>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput formControlName="sec4_titulo" required>
                    <mat-error *ngIf="mf.sec4_titulo.errors">
                        <span *ngIf="mf.sec4_titulo.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>

                <mat-form-field class="full" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="sec4_descripcion" required>
                    <mat-error *ngIf="mf.sec4_descripcion.errors">
                        <span *ngIf="mf.sec4_descripcion.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
            
            <div fxFlex="49%">
                <span class="cmlabel">Background Picture</span>
                <ng-container 
                    [ngTemplateOutlet]="picUploader" 
                    [ngTemplateOutletContext]="{ indexpic: 'sec4_imagen', inputtext: 'UPLOAD' } ">
                </ng-container>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>URL</mat-label>
                    <input matInput formControlName="sec4_url">
                </mat-form-field>
            </div>

            <div fxFlex="49%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Enable Button URL</mat-label>
                    <mat-select formControlName="sec4_habilitarUrl" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.sec4_habilitarUrl.errors">
                        <span *ngIf="mf.sec4_habilitarUrl.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="100%">
                <h3 class="sst">Extra Settings</h3>
            </div>
            
            <div fxFlex="33%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Category</mat-label>
                    <mat-select formControlName="idCategoria" required>
                        <mat-option *ngFor="let ee of categorias" [value]="ee._id">{{ ee.detalleEN }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.idCategoria.errors">
                        <span *ngIf="mf.idCategoria.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="66%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Friendly URL</mat-label>
                    <input matInput formControlName="slug" required>
                    <mat-error *ngIf="mf.slug.errors">
                        <span *ngIf="mf.slug.errors.required">Required</span>
                    </mat-error>
                    <mat-hint>How your article is found: <b>http://conectus.global/articles|articulos/{{ mainForm.value.slug }}</b></mat-hint>
                </mat-form-field>
            </div>

            <div fxFlex="24%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Show in Home Slide</mat-label>
                    <mat-select formControlName="mostrarEnSlide" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.mostrarEnSlide.errors">
                        <span *ngIf="mf.mostrarEnSlide.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxFlex="24%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Language</mat-label>
                    <mat-select formControlName="idioma" required>
                        <mat-option *ngFor="let ee of idiomas" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.idioma.errors">
                        <span *ngIf="mf.idioma.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div fxFlex="24%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>Position</mat-label>
                    <mat-select formControlName="posicion" required>
                        <mat-option *ngFor="let ii of [].constructor(99); let i = index" [value]="i">{{ i }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.posicion.errors">
                        <span *ngIf="mf.posicion.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
            <div fxFlex="24%">
                <mat-form-field class="full" appearance="outline">
                    <mat-label>State</mat-label>
                    <mat-select formControlName="habilitar" required>
                        <mat-option *ngFor="let ee of estados" [value]="ee.value">{{ ee.id }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="mf.habilitar.errors">
                        <span *ngIf="mf.habilitar.errors.required">Required</span>
                    </mat-error>
                </mat-form-field>
            </div>
        </div>
    </form>

</mat-dialog-content>
<mat-dialog-actions align="center">
    <button mat-flat-button class="primary-gray" [mat-dialog-close]="true">Cancel
    </button>
    <button mat-flat-button color="primary" (click)="save()">Save</button>
</mat-dialog-actions>

<ng-template #picUploader let-indexpic="indexpic" let-inputtext="inputtext">
    <div class="pic-agente"  >
        <input type="file" id="{{ indexpic }}" (change)="fileChange($event.target.files, indexpic)" 
        accept=".jpg, .png, .jpeg, .gif" hidden>
        <span *ngIf="!mainForm.value[indexpic]" class="btnsub" (click)="openInputFile(indexpic)">{{ inputtext }}</span>
        <img *ngIf="mainForm.value[indexpic] && !mainForm.value[indexpic].includes('data')"
            [src]="routeStorage + pathFicheros + mainForm.value[indexpic] + '?alt=media'" (click)="removerImagen(indexpic)">
        <img *ngIf="mainForm.value[indexpic]  && mainForm.value[indexpic].includes('data')"
            [src]="mainForm.value[indexpic]" (click)="removerImagen(indexpic)">
    </div>
</ng-template>